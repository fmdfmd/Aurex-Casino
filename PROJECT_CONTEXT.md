# AUREX Casino - Контекст проекта

## Общая информация
- **Название:** AUREX Casino - The Golden Empire of Win
- **Владельцы:** Александр и Андрей (заказчики)
- **Технический директор (CEO+CTO):** Павел (ты)
- **Стек:** Next.js (frontend) + Express.js (backend) + PostgreSQL
- **Хостинг:** Railway (backend + frontend + PostgreSQL)
- **Репозиторий:** https://github.com/Vantorrr/Aurex-Casino.git

## URLs
- **Backend:** https://aurex-casino-production.up.railway.app
- **Frontend:** https://zonal-insight-production-32f9.up.railway.app
- **Telegram канал:** https://t.me/aurex_casino
- **Telegram бот поддержки:** @aurex_support_bot

## Реализованные системы

### Бонусная система
- Приветственный пакет (4 депозита): 200%, 150%, 100%, 75%
- Кэшбэк еженедельный (5-15% в зависимости от VIP)
- Промокоды с различными типами бонусов
- Reload бонусы (отключены, код закомментирован)

### VIP система (5 уровней)
1. Bronze (0 очков) - 5% кэшбэк
2. Silver (5,000 очков) - 7% кэшбэк
3. Gold (25,000 очков) - 10% кэшбэк
4. Platinum (100,000 очков) - 12% кэшбэк
5. Emperor (500,000 очков) - 15% кэшбэк

### Система лояльности (магазин VIP очков)
- 1 очко за каждые 100₽ ставки
- Магазин: фриспины, бонусы, бусты (кэшбэк+, очки x2)
- Путь: `/api/loyalty/*`

### Вейджер (отыгрыш бонусов)
- Автоматически обновляется при каждой ставке
- Виджет прогресса на странице /wallet
- Компонент: `ActiveBonusWidget.tsx`

### Реферальная система
- 5 уровней партнёров (10-20% комиссии)
- Реферальный код генерируется автоматически

### Слоты
- Интеграция через Slots API
- Провайдер отдаёт игры, мы обрабатываем callback'и
- Пути: `/api/slots/*`, `/api/callback/*`

### Telegram бот (@aurex_support_bot)
- AI-ассистент Стефани (OpenRouter API)
- Тикет-система с менеджерами
- Папка: `/telegram-bot/`

## Структура БД (PostgreSQL)

### Основные таблицы:
- `users` - пользователи
- `transactions` - все транзакции (депозиты, выводы, ставки, выигрыши)
- `bonuses` - активные и завершённые бонусы
- `game_sessions` - игровые сессии
- `cashback_records` - начисления кэшбэка
- `loyalty_purchases` - покупки в магазине VIP
- `user_boosts` - активные бусты
- `tickets` - тикеты поддержки
- `promocodes` - промокоды
- `tournaments` - турниры

### Миграции:
- `001_init.sql` - основная схема
- `002_telegram_integration.sql` - Telegram поля
- `003_ticket_files.sql` - файлы в тикетах
- `004_loyalty_system.sql` - магазин лояльности
- `005_missing_columns.sql` - дополнительные колонки

## API структура

### Публичные:
- `/api/auth/*` - регистрация, логин
- `/api/slots/games` - список игр
- `/api/config/*` - конфигурация (VIP, промо, платежи)

### Требуют авторизации:
- `/api/users/*` - профиль, настройки
- `/api/payments/*` - депозиты, выводы
- `/api/bonuses/*` - бонусы пользователя
- `/api/cashback/*` - кэшбэк
- `/api/loyalty/*` - VIP очки и магазин
- `/api/referral/*` - реферальная программа
- `/api/tickets/*` - тикеты поддержки

### Админские (требуют is_admin):
- `/api/admin/*` - панель управления
- `/api/*/admin/*` - админ-эндпоинты в каждом роуте

## Важные решения

1. **MongoDB удалён** - только PostgreSQL для всех данных
2. **Reload бонусы отключены** - слишком щедрые (50% до 15к)
3. **Кэшбэк раз в неделю** - по понедельникам, вейджер x5
4. **VIP очки** - начисляются автоматически при ставках

## Что ещё нужно сделать

- [ ] Интеграция платёжных шлюзов (крипто, карты)
- [ ] Лицензия (Curacao или Anjouan)
- [ ] Интегратор игр (полный каталог слотов)
- [ ] SMS/Email верификация
- [ ] Найм саппортов

## Контакты для интеграций
- Платежи: искать High-Risk провайдеров
- Игры: искать агрегаторов (Pragmatic, Evolution и др.)

---
*Последнее обновление: Февраль 2026*
